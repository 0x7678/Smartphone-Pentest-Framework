#!/usr/bin/perl



use DBI;
use Cwd;
print "Content-type: text/html \n\n";



print <<"EOT";



<html>

 <head>



      <link rel="stylesheet" href="styles.css" />



 </head>

 <body>

<div name="view" id="view">

<form name="viewInfo" id="viewInfo" method="post"  action="menu.pl">

<fieldset>

     <legend><img src="bulb.jpg" height="100" width="350"></legend>

     <br /><br />

	<table border='1' align='center'>

	<tr><td colspan="5" align='center'>AGENT DATA</TD></TR>

	<tr><td>Agent</td><td>SMS Database</td><td>Contacts</td><td>Picture Location</td><td>Rooted?</td></tr>



EOT


$dir = getcwd;

$configfile = $dir . "/config";

 open(CONFIG, "+<$configfile");

while (<CONFIG>)

{

        chomp;

        s/#.*//;

        s/^\s+//;

        s/\s+$//;

        ($var, $value) = split(/\s*=\s*/, $_, 2);

        $Variables{$var} = ${value};

}

$Variables{"OS"} = $^O;



        $sqlserver = $Variables{"MYSQLSERVER"};

         $username = $Variables{"MYSQLUSER"};

         $password = $Variables{"MYSQLPASS"};

         $port = $Variables{"MYSQLPORT"};
        $dbh = DBI->connect("dbi:mysql:database=framework;host=$sqlserver;port=$port", $username,$password);

        $database = framework;











        $query1 = "SELECT id, number from agents"; 

        $sql1 = $dbh->prepare($query1);

        $q1Out = $sql1->execute;

        while (($id, $number) = $sql1->fetchrow_array())

        {

       

        	$query2 = "SELECT sms, contacts, picture, root from data where id=$id";

        	$sql2 = $dbh->prepare($query2);

                $q2Out = $sql2->execute;

                ($sms, $contacts, $picture, $root) = $sql2->fetchrow_array();

        	print "<tr><td>$number</TD><TD>$sms</TD><td>$contacts</TD><TD>$picture</TD><TD>                                             $root</TD></TR>";

	}



print <<"EOT";



</table>

<br /><br />





	<table border='1' align='center'>

	<tr><td colspan="4" align='center'>REMOTE ATTACKS</TD></TR>

	<tr><td>IP</td><td>Exploit</td><td>VULN</td><td>Agent</td></tr>



EOT







        $query3 = "SELECT ip, exploit, vuln, agent from remote"; 

        $sql3 = $dbh->prepare($query3);

        $sq1Out = $sql3->execute;

        while (($ip, $exploit, $vuln, $agent) = $sql3->fetchrow_array())

        {

       

       

             print "<tr><td>$ip</TD><TD>$exploit</TD><td>$vuln</TD><TD>$agent</TD></TR>";

	}



print <<"EOT";



</table>

<br /><br />





	<table border='1' align='center'>

	<tr><td colspan="3" align='center'>CLIENT SIDE ATTACKS</TD></TR>

	<tr><td>Number</td><td>Exploit</td><td>VULN</td></tr>



EOT







        $query4 = "SELECT number, exploit, vuln from client"; 

        $sql4 = $dbh->prepare($query1);

        $sq1Out = $sql4->execute;

        while (($number, $exploit, $vuln) = $sql4->fetchrow_array())

        {

       

        	                

        	print "<tr><td>$number</TD><TD>$exploit</TD><td>$vuln</TD></TR>";

	}



print <<"EOT";



</table>

<br /><br />

<input type="submit" class="submitButton" name="submitReturn" id="submitReturn" value="Return "/>

<br />&nbsp;<br />&nbsp;

</fieldset>

</form>

</div>



</body>

 </html> 







EOT






