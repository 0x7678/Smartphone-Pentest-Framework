#!/usr/bin/perl
BEGIN { use CGI::Carp qw(fatalsToBrowser); };



use DBI;
use Cwd;
use FindBin qw($Bin);
use lib "$Bin/lib";
use SPF;
print "Content-type: text/html \n\n";



print <<"EOT";



<html>

 <head>



      <link rel="stylesheet" href="styles.css" />



 </head>

 <body>

<div name="view" id="view">

<form name="viewInfo" id="viewInfo" method="post"  action="menu.pl">

<fieldset>

     <legend><img src="bulb.jpg" height="100" width="350"></legend>

     <br /><br />

	<table border='1' align='center'>

	<tr><td colspan="5" align='center'>AGENT DATA</TD></TR>

	<tr><td>Agent</td><td>SMS Database</td><td>Contacts</td><td>Picture Location</td><td>Rooted?</td></tr>



EOT










my %Variables = SPF::readconfig();
my $dbh = SPF::dbconnect(%Variables);
$Variables{"OS"} = $^O;

print "Content-type: text/html \n\n";















        $sql1 = $dbh->prepare("SELECT id, number from agents");

        $q1Out = $sql1->execute;

        while (($id, $number) = $sql1->fetchrow_array())

        {

       

        	$sql2 = $dbh->prepare("SELECT sms, contacts, picture, root from data where id=?");

                $q2Out = $sql2->execute($id);

                ($sms, $contacts, $picture, $root) = $sql2->fetchrow_array();

        	print "<tr><td>$number</TD><TD>$sms</TD><td>$contacts</TD><TD>$picture</TD><TD>                                             $root</TD></TR>";

	}



print <<"EOT";



</table>

<br /><br />





	<table border='1' align='center'>

	<tr><td colspan="4" align='center'>REMOTE ATTACKS</TD></TR>

	<tr><td>IP</td><td>Exploit</td><td>VULN</td><td>Agent</td></tr>



EOT







        $sql3 = $dbh->prepare("SELECT ip, exploit, vuln, agent from remote");

        $sq1Out = $sql3->execute;

        while (($ip, $exploit, $vuln, $agent) = $sql3->fetchrow_array())

        {

       

       

             print "<tr><td>$ip</TD><TD>$exploit</TD><td>$vuln</TD><TD>$agent</TD></TR>";

	}



print <<"EOT";



</table>

<br /><br />





	<table border='1' align='center'>

	<tr><td colspan="3" align='center'>CLIENT SIDE ATTACKS</TD></TR>

	<tr><td>Number</td><td>Exploit</td><td>VULN</td></tr>



EOT







        $sql4 = $dbh->prepare("SELECT number, exploit, vuln from client");

        $sq1Out = $sql4->execute;

        while (($number, $exploit, $vuln) = $sql4->fetchrow_array())

        {

       

        	                

        	print "<tr><td>$number</TD><TD>$exploit</TD><td>$vuln</TD></TR>";

	}



print <<"EOT";



</table>

<br /><br />

<input type="submit" class="submitButton" name="submitReturn" id="submitReturn" value="Return "/>

<br />&nbsp;<br />&nbsp;

</fieldset>

</form>

</div>



</body>

 </html> 







EOT






