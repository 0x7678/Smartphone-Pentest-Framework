#!/usr/bin/perl
BEGIN { use CGI::Carp qw(fatalsToBrowser); };
use DBI;
use Cwd;
use FindBin qw($Bin);
use lib "$Bin/lib";
use SPF;
my %Variables = SPF::readconfig();
use CGI ':cgi-lib';

my %FORM = Vars();
$ipAddress = $FORM{"ipAddressTB"};


##----- put your code here
#print "Content-type: text/html\r\n\r\n";


die "Bad IP" unless ($ipAddress =~ m/^(?:\d{1,3}.){3}\d{1,3}$/);
my @exec = (qw(perl sshattack.pl),$ipAddress);
$pid = fork;
die "fork failed" unless defined $pid;
if ($pid ==0)
{
	open STDIN,'<','/dev/null';
	open STDOUT,'<','/dev/null';
	open STDERR,'>&STDOUT';
	exec {$exec[0]} @exec;
}
##----- end of your code

my $url = "menu.pl";
print "Location: $url\n\n";
